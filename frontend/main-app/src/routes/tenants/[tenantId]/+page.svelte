<script lang="ts">
    import {cozauth} from "../../../lib/auth/cozauth";
    import MainPanel from "../../../lib/MainPanel.svelte";
    import {onMount} from "svelte";
    import {
        registerAllProperties,
        registerAllPropertyConfigurers,
        registerAllSlotEditors,
        registerAllSlotViewers
    } from "@cozemble/model-assembled";
    import {page} from '$app/stores';
    import {tenantStore} from "$lib/tenant/tenantStore.js";

    onMount(() => {
        registerAllProperties()
        registerAllPropertyConfigurers()
        registerAllSlotViewers()
        registerAllSlotEditors()
    })

</script>

{#await cozauth.getSession('root')}
    <p>loading...</p>
{:then session}
    {#if session && $tenantStore}
        <MainPanel tenantId={$page.params.tenantId}/>
    {:else }
        <h1>You need to login</h1>
    {/if}
{:catch error}
    <p style="color: red">{error.message}</p>
{/await}

